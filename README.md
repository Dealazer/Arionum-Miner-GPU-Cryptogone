
# Arionum GPU Miner, Cryptogone Edition #
GPU miner for [Arionum](https://www.arionum.com/)

This is a fork of [Guli's GPU miner](https://bitbucket.org/guli13/arionum-gpu-miner/src), adding windows support and many performance & stability improvements.

Please make sure you install latest Nvidia drivers if you use the CUDA miner !

## Prebuilt Binaries
If you do not want to compile the project by yourself, you can find up to date ready to go binaries at this address :

https://bitbucket.org/cryptogone/arionum-gpu-miner/downloads/

## How to use

1. Either compile yourself or get prebuilt binaries (see above)
2. Uncompress the archive somewhere on your hard drive
3. If you have a Nvidia card then it is better to use the CUDA version otherwise use OpenCL version
4. Edit `run_OpenCL.sh/bat` or `run_CUDA.sh/bat` to set miner id, wallet address and thread / batch count.
5. Launch `run_OpenCL.sh/bat` or `run_CUDA.sh/bat` and enjoy mining ! 

See **Tuning** section below for more advanced usage and choosing thread & batch count.

Also see the [FAQ](https://bitbucket.org/cryptogone/arionum-gpu-miner/src/master/FAQ.md) for more info

## Commandline Options

    -l, --list-devices                list all available devices and exit
    -d, --device(s)=DEVICES           GPU devices to use, examples: -d 0 / -d 1 / -d 0,1,3,5 [default: 0]
    -u, --use-all-devices             use all available GPU devices (overrides -d)
    -a, --address=ADDRESS             public arionum address [default: 419qwxjJLBRdAVttxcJVT84vdmdq3GP6ghXdQdxN6sqbdr5SBXvPU8bvfVzUXWrjrNrJbAJCvW9JYDWvxenus1pK]
    -p, --pool=POOL_URL               pool URL [default: http://aropool.com]
    -t, --threads-per-device=THREADS  number of threads to use per device, ex: -t 1 / -t 6,3 [default: 1]
    -b, --batch-per-device=BATCHES    number of batches to use per device, ex: -b 6 / -b 6,3 [default: 48]
    -i, --workerId=WORKER_ID          worker id [default: autogenerated]
        --skip-cpu-blocks             do not mine cpu blocks
        --skip-gpu-blocks             do not mine gpu blocks
    -?, --help                        show this help and exit

## Tuning performance

First check the list of compute devices on your system:

* For this, launch `listDevices_CUDA.bat/.sh` or `listDevices_OpenCL.bat/.sh`
* If no devices listed, means that CUDA / OpenCL drivers are not properly installed or you have no GPU.

Now decide which GPU device(s) you want to use for mining

* Usually you want all devices, for that use `-u` parameter
* If you want to only use specific devices, list them with -d parameter (ex: `-d 0,3` mines only on devices 0 and 3)
* On laptops combinining a gaming GPU with an Integrated GPU, only mine on the gaming GPU (usually `-d 0`)

Choosing `-t` value (number of threads):

* for **CUDA** always use `-t 1`
* for **OpenCL**, if your device has 2GB memory or less, use `-t 1` otherwise use `-t 2`

Choosing `-b` value (batch size):

* Ideal value is around: `((GPU_RAM_GB - 0.25) / (0.017 * number_of_threads)`
* It is advised to use an **even** value
* The higher `-b` is, the more GPU RAM will be used and the higher the hashrate will be (until memory bandwith limit 
 is hit)
* If you get a memory error or miner seems unstable/produces many bad shares, then reduce the `-b` value
* On some GPUs (like AMD Vega64) you might get better hashrate with a lower `-b` value than the ideal one
* So you'll need to fiddle a bit, trying values above / below the ideal one until you find a good compromise for your system.
* Also monitor Watt usage of your GPU for different `-b` values, sometimes it may be better to have a lower hashrate but save more energy (better ROI)

## Example -b / -t values

Here are some battle tested values for 2 / 4 / 8 GB GPUs, should be similar for other GPUs with same memory:

    AMD Vega64,          8GB, Win10, OpenCL => -t 2 -b 224
    NVIDIA GTX960,       4GB, Linux, CUDA   => -t 1 -b 224
    NVIDIA Quadro M500M, 2GB, Win10, CUDA   => -t 1 -b 104

## Building (Linux)

First, install CUDA SDK (https://developer.nvidia.com/cuda-downloads)

Then use the following commands:

    git clone https://bitbucket.org/cryptogone/arionum-gpu-miner.git
    cd arionum-gpu-miner
    ./setup_libs.sh linux
    ./setup_submodules.sh
    ./gen_prj.sh linux
    ./make_release_linux.sh

Once done, binaries are put in the `rel/`folder.

Note that `setup_libs.sh` may ask you for your password since it needs to install some packages with `apt-get`

## Building (Windows)

First install the following:

* Visual studio 2015 or 2017 (https://visualstudio.microsoft.com/fr/vs/community/)
* For Visual Studio 2017 make sure to select `Windows 8.1 SDK` during installation
* cuda sdk (https://developer.nvidia.com/cuda-downloads)
* cmake (https://cmake.org/download/), make sure `cmake.exe` is in the system `PATH`
* git for windows (https://git-scm.com/download/win)

Then open a git console and launch the following commands (if needed, replace `vs2015` by `vs2017`)

    git clone https://bitbucket.org/cryptogone/arionum-gpu-miner.git
    cd arionum-gpu-miner
    ./setup_libs.sh vs2015
    ./setup_submodules.sh
    ./gen_prj.sh vs2015
    ./make_release_win.sh

Once done, binaries are put in the `rel/`folder.

You can also skip the last step and instead open `build/arionum-gpu-miner.sln` with Visual Studio 2015 or 2017, then in the toolbar select `Release / x64` then `Build Menu -> Build Solution`.

## Versions release notes

#### Version 1.5.0 beta
* improved CPU block mining hashrate (now in line with Ariominer)
* fixed random crashes at launch
* --skip-cpu-blocks / --skip-gpu-blocks options
* use pinned memory (OpenCL)

#### Version 1.5.0 alpha
* fixed important memory leak
* CPU blocks mining now working 
  (but still way slower than Bogdan's)
* more accurate hashrate computations 
  (the displayed hashrate will probably be a bit lower than before, but more exact)
* now correctly reports CPU/GPU hashrate too pools
* can set worker name via -i parameter (you can also set it via the run_CUDA/run_OpenCL scripts)

#### Version 1.4.0 (08/23/2018)
* block 80k fork support, only mines GPU blocks, idle during CPU ones
* Linux support
* see the [FAQ](https://bitbucket.org/cryptogone/arionum-gpu-miner/src/master/FAQ.md) for more info

#### Version 1.3.0 (07/11/2018)
* fixed more OpenCL issues
* switched to a single thread managing all GPUs (improves stability)
* can now set batch size & thread count per device, for example:
*  -d 0 -t 1 -b 6
*  -d 0,1,2 -t 1 -b 6
*  -d 0,1,2 -t 1,2,1 -b 6,3,6
* -k parameter removed
* updated README.md with information on how to get the most out of your GPU(s)

#### Version 1.2.0 (07/02/2018)
* fix OpenCL miner (kernel file was missing in release zip)
* -k parameter now also works for the OpenCL miner
* show error message and stack trace whenever a CUDA or OpenCL exception occurs (will help fixing future issues)

#### Version 1.1.0 (06/27/2018)
* fix CUDA multi gpu support (-d & -u parameters)
* add -k parameter, allows to specify a list of gpu devices to use, ex: -k 0,3,7
* show error message when out of memory during CUDA kernel creation
